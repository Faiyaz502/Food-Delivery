<header class="w-full bg-white shadow-md border-b border-gray-200 font-sans relative mb-4 rounded">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <!-- LEFT: Search Bar - Hidden on small devices -->
          <div class="hidden md:flex items-center space-x-3 w-full max-w-md">
            <!-- Search Icon (SVG) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-400"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
            <input
              type="text"
              placeholder="Search..."
              class="w-full bg-gray-100 rounded-full px-4 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:bg-white transition"
            />
          </div>

          <!-- RIGHT: Icons + Profile -->
          <div class="flex items-center space-x-4 relative">

            <!-- Chat Dropdown - Hidden on small devices -->
            <div class="relative hidden md:block">
              <button
                (click)="toggleDropdown('chat')"
                class="relative p-2 hover:bg-gray-100 rounded-full transition duration-200"
                aria-label="Messages"
              >
                <!-- Chat Icon (SVG) -->
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-600"><path d="m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z"/></svg>
                <span class="absolute top-1 right-1 w-2 h-2 bg-green-500 rounded-full ring-2 ring-white"></span>
              </button>
              <div *ngIf="showChatDropdown" class="absolute right-0 mt-2 w-64 bg-white shadow-lg rounded-lg border border-gray-100 py-2 z-50 transform transition ease-out duration-150 origin-top-right">
                  <div class="px-4 py-2 text-gray-700 font-bold border-b border-gray-200">Messages</div>
                  <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                    <div class="flex items-center space-x-3">
                      <img src="https://i.pravatar.cc/40?img=1" alt="User" class="w-8 h-8 rounded-full object-cover rounded-full"/>
                      <div>
                        <p class="font-medium">Jane</p>
                        <p class="text-xs text-gray-500 truncate">Hey, are you free to chat?</p>
                      </div>
                    </div>
                  </a>
                  <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                    <div class="flex items-center space-x-3">
                      <img src="https://i.pravatar.cc/40?img=2" alt="User" class="w-8 h-8 rounded-full object-cover rounded-full"/>
                      <div>
                        <p class="font-medium">Mark</p>
                        <p class="text-xs text-gray-500 truncate">Thanks for the feedback!</p>
                      </div>
                    </div>
                  </a>
                  <a routerLink="chat" (click)="toggleDropdown('chat')" class="block px-4 py-2 text-blue-600 text-center hover:bg-gray-100">View All</a>
                </div>
            </div>

            <!-- Notifications Dropdown -->
    <!-- Notifications Dropdown -->
<div class="relative notification-bell">
  <button
    (click)="toggleDropdown('notifications')"
    class="relative p-2 hover:bg-gray-100 rounded-full transition duration-200"
    aria-label="Notifications"
  >
    <!-- Bell Icon -->
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
         viewBox="0 0 24 24" fill="none" stroke="currentColor"
         stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
         class="text-gray-600">
      <path d="M18.6 13.9c.7-.7.9-1.5.9-2.2v-1.1c0-1.6-.7-3.1-2-4.1-.7-.5-1.4-.9-2.2-1.3-.8-.3-1.6-.5-2.5-.5H12c-1.8 0-3.5.8-4.8 2.1-1.3 1.3-2 3-2.1 4.7l-.1.4c0 .4-.1.8-.1 1.2v1.1c0 .7.2 1.5.9 2.2.7.7 1.5.9 2.2.9h1.1c.4 0 .8-.1 1.2-.1.8-.1 1.6-.3 2.5-.5.8-.3 1.4-.7 2.2-1.3 1.3-1 2-2.5 2-4.1V12z"/>
      <path d="M12 21a2 2 0 0 0 2-2H10a2 2 0 0 0 2 2z"/>
    </svg>

    <!-- Badge -->
    <span
      *ngIf="unreadCount > 0"
      class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full ring-2 ring-white">
    </span>
  </button>

  <!-- Dropdown Panel -->
  <div
    *ngIf="showNotificationsDropdown"
    class="notification-panel absolute right-0 mt-3 w-80 bg-white shadow-xl rounded-lg border border-gray-200 py-3 z-50">
    
    <!-- Header -->
    <div class="flex justify-between items-center px-4 pb-2 border-b border-gray-200">
      <h2 class="text-lg font-semibold text-gray-800">Notifications</h2>

      <button
        *ngIf="unreadCount > 0"
        (click)="markAllAsRead(); $event.stopPropagation()"
        class="text-xs px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md">
        Mark all ({{ unreadCount }})
      </button>
    </div>

    <!-- Loading -->
    <div *ngIf="loading" class="text-center py-6">
      <i class="fas fa-spinner fa-spin text-2xl text-indigo-600"></i>
    </div>

    <!-- Empty -->
    <div *ngIf="!loading && notifications.length === 0" class="text-center py-6">
      <i class="fas fa-bell-slash text-4xl text-gray-300 mb-2"></i>
      <p class="text-gray-500 text-sm">No notifications</p>
    </div>

    <!-- Notifications List -->
    <div *ngIf="!loading && notifications.length > 0" class="max-h-64 overflow-y-auto">
      <div 
        *ngFor="let n of notifications"
        (click)="markAsRead(n.id); $event.stopPropagation()"
        class="px-4 py-3 border-b border-gray-100 cursor-pointer hover:bg-gray-50 transition"
        [class.bg-indigo-50]="!n.isRead"
      >
        <div class="flex justify-between">
          <p class="font-medium text-sm text-gray-800 truncate">{{ n.title }}</p>
          <span class="text-xs text-gray-500">{{ formatTimeAgo(n.createdAt) }}</span>
        </div>
        <p class="text-xs text-gray-600 mt-1">{{ n.message }}</p>
      </div>
    </div>

    <!-- View All -->
    <a
      routerLink="/notifications"
      class="block text-center text-indigo-600 hover:bg-gray-100 mt-2 py-2 text-sm">
      View All
    </a>

  </div>
</div>

            <!-- PROFILE Dropdown -->
            <div class="relative">
              <button
                (click)="toggleDropdown('profile')"
                class="flex items-center space-x-2 bg-gray-100 rounded-full p-1 pr-3 hover:bg-gray-200 transition duration-200"
                aria-haspopup="true"
              >
                <img [src]="user.imageUrl ? user.imageUrl : 'https://i.pravatar.cc/40'" alt="User" class="w-8 h-8 rounded-full object-cover" />
               
                <!-- Chevron Down Icon (SVG) -->
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-500 text-sm"><path d="m6 9 6 6 6-6"/></svg>
              </button>

              <div *ngIf="showProfileDropdown" class="absolute right-0 mt-2 w-48 bg-white shadow-lg rounded-lg border border-gray-100 py-2 z-50 transform transition ease-out duration-150 origin-top-right">
                  <a routerLink="profile" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                    <div class="flex items-center space-x-2">
                      <!-- Profile Icon (SVG) -->
                      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-500"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                      <span>Profile</span>
                    </div>
                  </a>
                  <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                    <div class="flex items-center space-x-2">
                      <!-- Settings Icon (SVG) -->
                      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-500"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.39a2 2 0 0 0 .73 2.73l.15.08a2 2 0 0 1 1 1.74v.44a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.39a2 2 0 0 0 .73 2.73l.15.08a2 2 0 0 1 1 1.74v.44a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 0 .73 2.73l.22.39a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.44a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
                      <span>Settings</span>
                    </div>
                  </a>
                  <button class="w-full text-left px-4 py-2 text-red-600 hover:bg-gray-100" (click)="Logout()">
                    <div class="flex items-center space-x-2">
                      <!-- Logout Icon (SVG) -->
                      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-red-500"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>
                      <span>Logout</span>
                    </div>
                  </button>
                </div>
            </div>
          </div>
        </div>
      </div>
    </header>
